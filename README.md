# üëÄ VITRina: VIsual Token Representations

[![Main](https://github.com/deepvk/vitrina/actions/workflows/main.yaml/badge.svg)](https://github.com/vitrina/actions/workflows/main.yaml)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
[![Checked with mypy](http://www.mypy-lang.org/static/mypy_badge.svg)](http://mypy-lang.org/)

## –î–∞–Ω–Ω—ã–µ
[Toxic Russian Comments](https://www.kaggle.com/datasets/alexandersemiletov/toxic-russian-comments) -- –¥–∞—Ç–∞—Å–µ—Ç –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤ –¥–ª—è –∑–∞–¥–∞—á–∏ multi-label –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. 
–°–∫–∞—á–∞–π—Ç–µ —ç—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ [`resources/data`](./resources/data).

–°–∫—Ä–∏–ø—Ç [`scripts/prepare_ok_dataset.py`](./scripts/prepare_ok_dataset.py) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç jsonl –∏ –∑–∞–º–µ–Ω—è–µ—Ç –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–∞ –Ω–∞ –±–∏–Ω–∞—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 1 -- —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π,
0 -- –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
```angular2html
python scripts/prepare_ok_dataset.py --data=resources/data/dataset.txt --save-to=resources/data/dataset.jsonl
```

## –°–∫—Ä–∏–ø—Ç—ã

–í—Å–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ [`scripts`](./scripts)

[__scripts/clusterization.py__](./scripts/clusterization.py) -- —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —É–∫–∞–∑–∞–Ω–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º.

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:_
* `--font-path` -- –ø—É—Ç—å –∫ —à—Ä–∏—Ñ—Ç—É, –∫–æ—Ç–æ—Ä—ã–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (_default_: fonts/NotoSans.ttf)
* `--font-size` -- —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (_default_: 13)
* `--clusters` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–±–∏–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–æ–≤ (_default_: 500)
```angular2html
python scripts/clusterization.py --font-path=resources/fonts/NotoSans.ttf --font-size=13 --clusters=500
```

[__scripts/generate_noisy_dataset.py__](./scripts/generate_noisy_dataset.py) -- —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞—à—É–º–ª–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞.
–£—Ä–æ–≤–µ–Ω—å –∑–∞—à—É–º–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. `level-toxic` –∏ `level-non-toxic` –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±–µ—Ä—ë—Ç—Å—è –∑–∞–º–µ–Ω–∞ –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.
–ó–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å {1, 2, 3, 4}. –ö–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∑–∞–º–µ–Ω—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ.

1 -- –∑–∞–º–µ–Ω–∞ –Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏–µ —Ü–∏—Ñ—Ä—ã ([resources/letter_replacement/letters1.json](resources/letter_replacement/letters1.json))

2 -- –∑–∞–º–µ–Ω–∞ –Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏–ª–∏ –∏–∑ –ª–∞—Ç–∏–Ω–∏—Ü—ã ([resources/letter_replacement/letters2.json](resources/letter_replacement/letters2.json))

3 -- –∑–∞–º–µ–Ω–∞ –Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–æ–≤ ([resources/letter_replacement/letters3.json](resources/letter_replacement/letters3.json))

4 -- –∑–∞–º–µ–Ω–∞ –Ω–∞ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Ç–æ–≥–æ –∂–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Å–º. scripts/clusterization.py) ([resources/letter_replacement/clusterization.json](resources/letter_replacement/clusterization.json))

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:_
* `--data` -- –ø—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É
* `--level-toxic` -- —É—Ä–æ–≤–µ–Ω—å –∑–∞—à—É–º–ª–µ–Ω–∏—è —Ç–æ–∫—Å–∏—á–Ω—ã—Ö —Å–ª–æ–≤ (_default_: 4)
* `--level-non-toxic` -- —É—Ä–æ–≤–µ–Ω—å –∑–∞—à—É–º–ª–µ–Ω–∏—è –Ω–µ—Ç–æ–∫—Å–∏—á–Ω—ã—Ö —Å–ª–æ–≤ (_default_: 2)
* `--p-toxic-word` -- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–æ–∫—Å–∏—á–Ω–æ–µ —Å–ª–æ–≤–æ (_default_: 0.5)
* `--p-toxic-symbol` -- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∞ (_default_: 0.5)
* `--p-non-toxic-symbol` -- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∞ –≤ –Ω–µ—Ç–æ–∫—Å–∏—á–Ω–æ–º —Å–ª–æ–≤–µ (_default_: 0.1)
* `--p-space` -- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–∞ –ø–æ—Å–ª–µ —Å–∏–º–≤–æ–ª–∞ (_default_: 0.01)
* `--sl` -- –µ—Å–ª–∏ —Ñ–ª–∞–≥ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω, —Ç–æ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –∑–∞–¥–∞—á–∏ sequence labeling (—Ä–∞–∑–º–µ—Ç–∫–∏ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤)
* `--save-to` -- –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∑–∞—à—É–º–ª—ë–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (_default_: resources/data/noisy_dataset.jsonl)
```angular2html
python scripts/generate_noisy_dataset.py --data=resources/data/dataset.jsonl --level-toxic=4 --level-non-toxic=2 --p-toxic-word=0.5 --p-toxic-symbol=0.5 --p-space=0.01 --p-non-toxic-symbol=0.1 --save-to=resources/data/noisy_dataset.jsonl
```

[__scripts/prepare_ok_dataset.py__](./scripts/prepare_ok_dataset.py) -- —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å.

`__label__INSULT —Å–∫–æ—Ç–∏–Ω–∞! —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å` -> `{"text": "—Å–∫–æ—Ç–∏–Ω–∞! —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å", "toxic": 1}`

–í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –∏–º–µ–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ jsonl –∏ –≤—Å–µ –º–µ—Ç–∫–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏–º–µ—é—Ç –±–∏–Ω–∞—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:_
* `--data` -- –ø—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É (_default_: resources/data/dataset.txt)
* `--save-to` -- —Ñ–∞–π–ª, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç (_default_: resources/data/ok_toxic.jsonl)

```angular2html
python scripts/prepare_ok_dataset.py --data=resources/data/dataset.txt --save-to=resources/data/dataset.jsonl
```

[__scripts/train_tokenizer.py__](./scripts/train_tokenizer.py) -- —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è WordPiece —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —ç–Ω–∫–æ–¥–µ—Ä–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞.

_–¢–∞–∫ –∫–∞–∫ –º—ã —Ö–æ—Ç–∏–º –æ–±—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏ —ç—Ç–æ–º –¥–∞—Ç–∞—Å–µ—Ç –Ω–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, —Ç–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, 
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–æ–∫, –∞ —Ç–∞–∫ –∂–µ random-state —Å –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —ç—Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤ [`src/train.py`](./src/train.py).
–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç –≤—ã–±–æ—Ä–∫—É –∏ –æ–±—É—á–∏—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç—Ä —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π —á–∞—Å—Ç–∏._
__TODO__: –∏—Å–ø—Ä–∞–≤–∏—Ç—å (—Ä–∞–∑–±–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã)

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:_
* `--data` -- –¥–∞–Ω–Ω—ã–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—É—á–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä (_default:_ resources/data/noisy_dataset.jsonl)
* `--test-size` -- —Ä–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (_default:_ 0.1)
* `--val-size` -- —Ä–∞–∑–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ (_default:_ 0.1)
* `--random-state` (_default:_ 21)
```angular2html
python scripts/train_tokenizer.py --data=resources/data/noisy_dataset.jsonl --test-size=0.1 --val-size=0.1 --random-state=21 --save-to=tokenizer
```
## –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

–û–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—ã–∑–æ–≤–æ–º
```angular2html
python src/train.py
```

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:_
* `--data` -- –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (_default:_ resources/data/noisy_dataset.jsonl)
* `--max-seq-len` -- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤. –í —Å–ª—É—á–∞–µ vtr -- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–∞–π—Å–æ–≤, –≤ —Å–ª—É—á–∞–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ -- –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤. (_default_: 512)
* `--epochs` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è (_default:_ 10)
* `--test-size` -- —Ä–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (_default:_ 0.1)
* `--val-size` -- —Ä–∞–∑–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ (_default:_ 0.1)
* `--random-state` (_default:_ 21)
* `--log-every` -- –∫–∞–∫ —á–∞—Å—Ç–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ wandb (_default:_ 1000)
* `--num-workers` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –≤ DataLoader (_default:_ 1)
* `--save-to` -- –ø—É—Ç—å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–æ, –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ –≤–µ—Å–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.
* `--beta1`, `--beta2` -- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ Adam (_default:_ 0.9, 0.999)
* `--sl` -- –µ—Å–ª–∏ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω, –∑–Ω–∞—á–∏—Ç —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑–º–µ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
* `--test-data` -- –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω, —Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –Ω–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏. –ö–∞—á–µ—Å—Ç–≤–æ –º–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∏—Ç –ø–æ –ø—É—Ç–∏ `test-data` (_default:_ None)
* `--val` -- –µ—Å–ª–∏ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω, —Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, –∏–Ω–∞—á–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π (TODO: –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å)
* `--dropout` -- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å dropout
* `--device` -- cuda –∏–ª–∏ cpu
* `--warmup` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è —Ä–∞–∑–æ–≥—Ä–µ–≤–∞ Linear Scheduler (_default:_ 1000)
* `--batch-size` -- —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (_default:_ 32)
* `--lr` -- learning rate (_default:_ 5e-5)

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è vtr:_
* `--max-slices-count-per-word` -- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–∞–π—Å–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –∏–∑—É—á–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª–æ–≤ –º–æ–∂–Ω–æ –≤–∑–≥–ª—è–Ω—É–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (_default:_ 9)
![](`r https://sun9-43.userapi.com/impg/frHiG2LjSyGa9b3hVmhrDx678d3yoE6gAahe-w/kO7oP431eEg.jpg?size=2298x1322&quality=95&sign=fa872fbd34c5598b417954219cbdc076&type=album`)
* `--font-size` -- —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (_default:_ 15)
* `--window-size` -- —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ (_default:_ 30)
* `--stride` -- —Ä–∞–∑–º–µ—Ä —à–∞–≥–∞ –æ–∫–Ω–∞
* `--emb-size` -- —Ä–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–∞, –ø–æ–ª—É—á–∞–µ–º—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ (_default:_ 768)
* `--font` -- —à—Ä–∏—Ñ—Ç, –∫–æ—Ç–æ—Ä—ã–º –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤
* `--out-channels` -- —á–∏—Å–ª–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–≤—ë—Ä—Ç–æ—á–Ω–æ–º —Å–ª–æ–µ (_default:_ 256)
* `--nhead` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤ —Å–ª–æ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ (_default:_ 12)
* `--kernel-size` -- —Ä–∞–∑–º–µ—Ä —è–¥—Ä–∞ —Å–≤—ë—Ä—Ç–∫–∏ (_default:_ 3)
* `--num-layers` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—ë–≤ —ç–Ω–∫–æ–¥–µ—Ä–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ –≤ –º–æ–¥–µ–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (_default:_ 1)

_–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å–ª–æ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞:_
* `--tokenizer` -- –ø—É—Ç—å –∫ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä—É, —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —Å–∫—Ä–∏–ø—Ç–æ–º [`scripts/train_tokenizer.py`](./scripts/train_tokenizer.py). (_default:_ )


## Structure

- [`src`](./src) ‚Äí main source code with model and dataset implementations and code to train, test or infer model.
- [`notebooks`](./notebooks) ‚Äí notebooks with experiments and visualizations.
- [`scripts`](./scripts) ‚Äí different useful scripts, e.g. print dataset examples or evaluate existing models.
- [`tests`](./tests) ‚Äí unit tests.

## Requirements

Create virtual environment with `venv` or `conda` and install requirements:
```bash
pip install -r requirements.txt
```

For proper contributions, also use dev requirements:
```bash
pip install -r requirements-dev.txt
```

